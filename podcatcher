#!/usr/bin/make -f

s ?= $(error Usage: podcatcher s=file.ini)
export timestamp = $(t)

src := $(dir $(realpath $(lastword $(MAKEFILE_LIST))))

filter-out-downloaded := cat

all:
	$(MAKE) --no-print-directory -f $(src)/ini-parse.mk `ruby $(src)/ini-parse.rb "$(s)"` | $(filter-out-downloaded) | ruby $(src)/enclosures-print.rb | xargs make -f $(src)/generate.mk
	make -f dl.mk
